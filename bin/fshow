#!/bin/bash
#
# Repeatedly choose commits and `git show` them.

set -e

git rev-parse --is-inside-work-tree >/dev/null

previous_query=
while lines=$(fzc -pq "$previous_query" -- "$@"); do
  previous_query=$(head -1 <<<"$lines")
  results=$(tail -n +2 <<<"$lines")
  while read -r line; do
    git show --color=always -m "$line"
  done <<<"$results"
done
